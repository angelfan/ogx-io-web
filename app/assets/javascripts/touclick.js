/* Copyright (c) 2012-2013 HANGZHOUWEICHUKEJI.Co.,Ltd. All rights reserved. TouClick-Type: Classical*/(function(){ var touclicks='mVgg7E-Sg1pgZFkKJA8huaOuFVzHee3-A7tFTdJAVgTyX57f6sW-Au-AGOxqR50PTJRLeujOq-AiAIhVmvcpoM-AtwTWPi2DbyI9n4m3vUFgrlvjAIbARZ-AKk1cVX3qbP89nb8jopBwprwdBSSi-SK504rewj7wC-SP0F9pr';var touclick_isvip=0; var skinPath = "http://js.touclick.com/Configure/image/classical/4-14/"; var skinobj = { skinName: "white", background_shade_color: "#000", text_color_note: '#333', text_color_texted: '#069', text_color_text: '#c00', starthei: -179 }; var skinName = skinobj.skinName; var background_shade_color = skinobj.background_shade_color; var text_color_note = skinobj.text_color_note; var text_color_texted = skinobj.text_color_texted; var text_color_text = skinobj.text_color_text; var starthei = skinobj.starthei; var touclick_pic1_path = skinPath + skinName; var touclick_pic2_path = skinPath + skinName; if (window.ActiveXObject && navigator.userAgent.toLocaleLowerCase().match(/msie ([\d.]+)/)[1] == "6.0") { touclick_pic1_path += '/ie6/1.gif'; touclick_pic2_path += '/ie6/2.gif'; } else { touclick_pic1_path += '/1.png'; touclick_pic2_path += '/2.png'; }; var html = '<div id="touclick" style="display:none;position:fixed;z-index:10000;top:50%;left:50%;margin-left:-189px;margin-top:-154px"><table cellspacing="0"cellpadding="0"><tbody><tr style="height:10px;"><td class="touclick-tou1 touclick-pic1"style="background-position:0px 0px;"></td><td class="touclick-tou2 touclick-pic1"style="background-position:-11px 0px;"></td><td class="touclick-tou3 touclick-pic1"style="background-position:-367px 0px;"></td></tr><tr style="height:179px;"><td class="touclick-tou1 touclick-pic2"style="background-position:0px 0px;"></td><td class="touclick-tou2"><div style="width:356px;height:179px;overflow:hidden;position:relative;background-color:#fff;"><img id="touclick-backup"style="display:none;"/><img id="touclick-image"/></div></td><td class="touclick-tou3 touclick-pic2"style="background-position:-11px 0px;"></td></tr><tr style="height:119px;"><td class="touclick-tou1 touclick-pic1"style="background-position:0px -10px;"></td><td class="touclick-tou2 touclick-pic1"style="background-position:-11px -10px;vertical-align:top;"><div class="touclick-font"><span class="touclick-font14 touclick-color-note">&#28857;&#35302;&#39564;&#35777;&#58;</span><span class="touclick-font16 touclick-color-note"id="touclick-note">&#20381;&#27425;&#28857;&#20987;&#22270;&#20013;</span><span class="touclick-font16 touclick-color-texted"id="touclick-texted">""</span><span class="touclick-font16 touclick-color-text"id="touclick-text">""</span></div><div id="touclick-reload"class="touclick-pic1 touclick-reload-normal"></div></td><td class="touclick-tou3 touclick-pic1"style="background-position:-367px -10px;"></td></tr></tbody></table></div><style>#touclick{display:none;position:fixed;z-index:10000;top:50%;left:50%;margin-left:-189px;margin-top:-154px}.touclick-tou1,.touclick-tou3{width:11px}.touclick-tou2{width:356px}.touclick-pic1{background-image:url(' + touclick_pic1_path + ')}.touclick-pic2{background-image:url(' + touclick_pic2_path + ')}#touclick-reload{margin:0px auto 0px auto;cursor:pointer;width:47px;height:49px}.touclick-reload-normal{background-position:0px -129px}.touclick-reload-normal:hover{background-position:-47px -129px}.touclick-reload-click{background-position:-94px -129px}.touclick-font{font-family:\'Microsoft YaHei\';cursor:default;text-align:center;height:55px;line-height:59px}.touclick-font14{font-size:14px;font-weight:bold}.touclick-font16{font-size:16px}.touclick-color-note{color:' + text_color_note + '}.touclick-color-text{color:' + text_color_text + ';font-weight:bold}.touclick-color-texted{color:' + text_color_texted + ';font-weight:bold}</style>'; var TouEvent={attachEvent:function(){if(Global.statu){addEvent(Global.image,"click",fun_clickarea);Global.reloadevent=reload('click');addEvent(Global.reload,"click",Global.reloadevent);Global.statu=false}},detachEvent:function(){if(!Global.statu){removeEvent(Global.image,"click",fun_clickarea);removeEvent(Global.reload,"click",Global.reloadevent);Global.statu=true}}};var Change={toLoading:function(){Global.wait.style.display="block";Global.image.style.display="none";Global.imagebackup.style.display="none";TouEvent.detachEvent();setTimeout(TouEvent.attachEvent,1000)},toImage:function(){Global.wait.style.display="none";Global.imagebackup.style.display="none";Global.image.style.display="block";Global.image.style.visibility="visible";Global.isFirst=1;Global.clicknum=0;TouEvent.attachEvent();Global.isImgLoad=true},toTiping:function(){Global.wait.style.display="none";Global.image.style.display="none";Global.imagebackup.style.display="block";Global.imagebackup.src=Global.tipingpicurl;TouEvent.detachEvent()},toFail:function(){Global.wait.style.display="none";Global.image.style.display="none";Global.imagebackup.style.display="block";Global.imagebackup.src=Global.failpicurl;TouEvent.detachEvent()},toSuccess:function(){Global.imagebackup.src=Global.successpicurl;Global.imagebackup.style.display="block";Global.image.style.display="none";Global.wait.style.display="none";TouEvent.detachEvent()}};var Global={touclick:null,isie6:false,imageparent:null,image:null,imagebackup:null,wait:null,reload:null,lock:null,clickResult:"",texted:"",text:"",textArr:[],start:touStart,clicknum:0,textnum:0,b:'',c:"3",t:"1",s:"",i:"",requesturl:"http://request.touclick.com/captcharequest.touclick?",testurl:"http://test.touclick.com/captchatest.touclick?",statu:true,isImgLoad:false,isFirst:0,tipingpicurl:skinPath+skinName+"/tiping.gif",failpicurl:skinPath+skinName+"/fail.jpg",successpicurl:skinPath+skinName+"/success.jpg",is_successpicload:false,reloadevent:null,ErrorToLocal:null,args:null,loading_fn:null,loaded_fn:null,success_fn:null,fail_fn:null,isTouch:false};var isinit=false,hasObj=false,isstart=false;var DOMContentLoaded=function(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);init()}else if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);init()}};if(document.readyState==="complete"){setTimeout(init,1)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",init,false)}else{document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",init);var top=false;try{top=window.frameElement==null&&document.documentElement}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!isinit){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}init()}})()}}setTimeout(init,typeof(TOUCLICK_TIME_OUT)==='number'&&TOUCLICK_TIME_OUT>0?TOUCLICK_TIME_OUT:3000);function init(){if(isinit){return}isinit=true;var divFragment=document.createElement("div");divFragment.innerHTML=html;while(divFragment.firstChild){document.body.appendChild(divFragment.removeChild(divFragment.firstChild))};if(isEventSupported("touchstart")===true){Global.isTouch=true};Global.touclick=getObj("touclick");Global.image=getObj("touclick-image");Global.imageparent=Global.image.parentElement;Global.imagebackup=getObj("touclick-backup");var useragent=navigator.userAgent.toLocaleLowerCase();var ieagent=false;if(window.ActiveXObject&&useragent.match(/msie ([\d.]+)/)[1]=="6.0"){Global.isie6=true;Global.wait=(function(){var img=new Image();img.src=skinPath+skinName+'/loading.gif';img.style.position='absolute';img.style.left='138px';img.style.top='49px';Global.imageparent.appendChild(img);return img})()}else{Global.wait=initloading("touclick-wait",Global.imageparent,50,5,50)};Global.lock=new lock();Global.reload=getObj("touclick-reload");Global.texted=getObj("touclick-texted");Global.text=getObj("touclick-text");if(hasObj){touStart(hasObj)}};function touStart(obj){if(!isinit&&console&&typeof(console.log)==='function'){console.log('isnot init');hasObj=obj;return}if(isstart){}isstart=true;if(typeof(obj)!='object'){obj={}};var website_key=obj.website_key;var position_code=obj.position_code;var init_fn=obj.onInit;var success_fn=obj.onSuccess;var error_fn=obj.onError;var fail_fn=obj.onFail;var loading_fn=obj.onLoading;var loaded_fn=obj.onLoaded;var args=obj.args;var captcha_style=obj.captcha_style;var fn_arr={'success_fn':success_fn,'loading_fn':loading_fn,'loaded_fn':loaded_fn,'fail_fn':fail_fn};for(var fn_arr_item in fn_arr){var fn=fn_arr[fn_arr_item];if(typeof(fn)==='function'){Global[fn_arr_item]=fn}else{Global[fn_arr_item]=function(){}}};if(typeof(position_code)==='number'&&position_code<100&&position_code>10){Global.c=position_code}else{Global.c=0};if(typeof(args)==='undefined'){Global.args=null}else{Global.args=args};Global.ErrorToLocal=function(){close();Global.touclick.innerHTML+="<div style='display:none;'>ErrorToLocal</div>";if(typeof(error_fn)==='function'){error_fn(Global.args)}};if(typeof(website_key)==='undefined'||!website_key){Global.touclick.innerHTML+="<div style='display:none;'>pubkey is null</div>";Global.ErrorToLocal();return};Global.b=website_key;if(website_key.length!=36){Change.toTiping()}else{reload();if(Global.isFirst===0){setTimeout(function(){if(Global.isFirst===0){reload()}},1500)}};if(Global.isie6||Global.isTouch){Global.touclick.style.position="absolute";var top=Math.max(document.documentElement.scrollTop,document.body.scrollTop)+document.documentElement.clientHeight/2;top=top>153?top:153;Global.touclick.style.top=top+"px"};Global.lock.show(Global.isie6);if(typeof(captcha_style)==='object'){var style=Global.touclick.style;for(var style_item in captcha_style){style[style_item]=captcha_style[style_item]}};addEvent(Global.reload,'mousedown',reload('down'));addEvent(document,'mouseup',reload('up'));addEvent(Global.image,"load",Change.toImage);Global.touclick.style.display="block";if(typeof(init_fn)==='function'){init_fn(args)}};function reload(action){if(action==='down'){return function(){Global.reload.className='touclick-pic1 touclick-reload-click'}}else if(action==='up'){return function(){Global.reload.className='touclick-pic1 touclick-reload-normal'}}else if(action==='click'){return function(){Change.toLoading();touclick_jsonp("js="+touclicks+"&b="+Global.b+"&c="+Global.c+"&t="+Global.t+"&s="+Global.s,"getAjax");Global.loading_fn(Global.args)}}else{reload('click')()}};function Test(){touclick_jsonp("js="+touclicks+"&b="+Global.b+"&c="+Global.c+"&s="+Global.s+"&r="+Global.clickResult,"Test");if(!Global.is_successpicload){var img=new Image();img.src=Global.successpicurl;Global.is_successpicload=true}};function checkadblock(){if(Global.image.style.visibility==="hidden"){Global.image.style.visibility="visible"}};function checkimageload(){if(Global.isImgLoad===false){Change.toImage()}};function Callback(p,n,t,UrlAd,c,ts,e,i,ser){var c_temp=c.split("");c=c_temp[0];if(c=="1"){Global.image.src=restore(p[0].Entity);Global.isImgLoad=false;setTimeout(checkimageload,300);setInterval(checkadblock,100);Global.text.innerHTML=arrtotext(t);Global.texted.innerHTML="";Global.textArr=t;Global.textnum=n;Global.s=ts;Global.i=i;Global.loaded_fn(Global.args)}else if(c=="3"){Global.s=ts;Change.toFail();setTimeout(function(){reload()},700);Global.fail_fn(Global.args)}else if(c=="2"){Global.s=ts;Change.toSuccess();Global.success_fn(Global.args,{check_key:Global.i,check_address:ser});Global.lock.close();setTimeout(function(){close()},1700)}else{Global.ErrorToLocal()}};function fun_clickarea(e){stopDefault(e);var obj={};if(e.offsetX&&e.offsetY){obj.X=e.offsetX;obj.Y=e.offsetY}else if(e.layerX&&e.layerY){obj.X=e.layerX;obj.Y=e.layerY};if(Global.clicknum<Global.textnum){Global.clicknum++;addpro(Global.clicknum);if(Global.clicknum==1){Global.clickResult=obj.X+","+obj.Y}else{Global.clickResult+=","+obj.X+","+obj.Y}};if(Global.clicknum==Global.textnum){setTimeout(function(){Test()},100)}};function restore(b64){if(typeof(b64)!="object"){return b64};var ran_count=parseInt(Math.random()*500);var count_a=(b64.countA-ran_count)%4+ran_count;for(var i=0;i<count_a;i++){b64.baseStr+='A'};for(var i=0;i<b64.countEqual;i++){b64.baseStr+='='};return'data:image/jpg;base64,'+b64.baseStr};function arrtotext(t){var res="";for(var i=0;i<t.length;i++){res+="\""+t[i]+"\""};return res};function addpro(num){Global.texted.innerHTML="";Global.text.innerHTML="";for(var i=0;i<Global.textnum;i++){if(i<num){Global.texted.innerHTML+="\""+Global.textArr[i]+"\""}else{Global.text.innerHTML+="\""+Global.textArr[i]+"\""}}};function touclick_jsonp(query,type){var head=document.getElementsByTagName("head")[0];var js=document.createElement("script");var ran=Math.random();if(type=="getAjax"&&query!=""&&query!=null){if(typeof(touclick_clientname)!='undefined'&&typeof(touclick_clientid)!='undefined'){js.src=Global.requesturl+query+"&un="+escape(touclick_clientname)+"&ud="+escape(touclick_clientid)+"&ran="+ran}else{js.src=Global.requesturl+query+"&ran="+ran}}else if(type=="Test"&&query!=""&&query!=null){if(typeof(touclick_clientname)!='undefined'&&typeof(touclick_clientid)!='undefined'){js.src=Global.testurl+query+"&un="+escape(touclick_clientname)+"&ud="+escape(touclick_clientid)+"&ran="+ran}else{js.src=Global.testurl+query+"&ran="+ran}};js.onload=js.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){head.removeChild(js)}};head.appendChild(js)};function isEventSupported(eventName,element){var TAGNAMES={'select':'input','change':'input','submit':'form','reset':'form','error':'img','load':'img','abort':'img'};element=element||document.createElement(TAGNAMES[eventName]||'div');eventName='on'+eventName;var isSupported=(eventName in element);if(!isSupported){if(!element.setAttribute){element=document.createElement('div')};if(element.setAttribute&&element.removeAttribute){element.setAttribute(eventName,'');isSupported=typeof element[eventName]=='function';if(typeof element[eventName]!='undefined'){element[eventName]=void 0};element.removeAttribute(eventName)}};element=null;return isSupported};function initloading(id,par,h,r,time){var pardiv=document.getElementById(id);if(!pardiv){var pardiv=document.createElement("div");pardiv.id=id;pardiv.style.width=h+"px";pardiv.style.height=h+"px";pardiv.style.visibility="visible";pardiv.style.display="block";pardiv.style.position="absolute";pardiv.style.left=(parseInt(par.style.width)-h)/2+"px";pardiv.style.top=(parseInt(par.style.height)-h)/2+"px";par.appendChild(pardiv)};while(pardiv.firstChild){pardiv.removeChild(pardiv.firstChild)};var posArr=[];var _r=h/2-r;var aqr=_r*0.707;var h2=h/2;posArr.push([h2,r]);posArr.push([h2+aqr,h2-aqr]);posArr.push([h-r,h2]);posArr.push([h2+aqr,h2+aqr]);posArr.push([h2,h-r]);posArr.push([h2-aqr,h2+aqr]);posArr.push([r,h2]);posArr.push([h2-aqr,h2-aqr]);function getpoi(r,x,y){return[x-r,y-r]};var divArr=[];var count_hei=-179;if(typeof(starthei)=='undefined'){count_hei=-179}else{count_hei=starthei};for(var i=0;i<8;i++){var div=document.createElement("div");div.style.width=2*r+"px";div.style.height=2*r+"px";div.className="touclick-pic2";div.style.backgroundPosition="0px "+(count_hei-i*10)+"px";div.style.position="absolute";var poi=getpoi(r,posArr[i][0],posArr[i][1]);div.style.left=poi[0]+"px";div.style.top=poi[1]+"px";divArr.push(div);pardiv.appendChild(div)};var mour=0;function interval(){mour=mour%8;for(var i=0;i<8;i++){var _i=(i+mour)%8;var poi=getpoi(r,posArr[_i][0],posArr[_i][1]);divArr[i].style.left=poi[0]+"px";divArr[i].style.top=poi[1]+"px"};mour++};setInterval(interval,time);return pardiv};function lock(){var div_dom=null;this.show=function(isie6){div_dom.style.display='block';if(isie6===true){var style=div_dom.style;style.position='absolute';var height=Math.max(document.documentElement.clientHeight,document.body.clientHeight);style.height=height+'px'}};this.close=function(){div_dom.style.display='none'};div_dom=document.createElement("div");var style=div_dom.style;style.display="none";style.position="fixed";style.left="0px";style.top="0px";style.zIndex="9999";style.height=style.width="100%";var back_shade_color='#000';if(typeof(background_shade_color)!='undefined'){back_shade_color=background_shade_color};style.backgroundColor=back_shade_color;addEvent(div_dom,'click',close);style.opacity="0.5";style.filter="alpha(opacity=50)";function appendtobody(){if(document.readyState=='complete'){document.body.appendChild(div_dom)}else{setTimeout(appendtobody,50)}};appendtobody()};function close(){Global.lock.close();Global.touclick.style.display="none";TouEvent.detachEvent()};function stopDefault(e){if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false};return false};function getObj(id){return document.getElementById(id)};function addEvent(obj,eventName,fn){if(obj.addEventListener){obj.addEventListener(eventName,fn,false)}else{obj.attachEvent("on"+eventName,fn)}};function removeEvent(obj,eventName,fn){if(obj.removeEventListener){obj.removeEventListener(eventName,fn,false)}else if(obj.detachEvent){obj.detachEvent("on"+eventName,fn)}else{obj["on"+eventName]=null}};var touclick=window['TouClick']||{};touclick.Start=Global.start;touclick.Callback=Callback;touclick.Close=close;touclick.Reload=reload('click');window['TouClick']=touclick})();var TouclickCallback=TouClick.Callback;